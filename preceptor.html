<!DOCTYPE html> <!-- Indica que el documento usa HTML5 -->
<html lang="es"> <!-- Define el idioma principal como espa√±ol -->
<head>
  <meta charset="UTF-8"> <!-- Codificaci√≥n UTF-8 (para √±, tildes, etc.) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Hace que la p√°gina sea responsive -->
  <title>Panel de Preceptor - Registro de Asistencia</title> <!-- T√≠tulo que aparece en la pesta√±a -->

  <!-- Framework Bulma (para estilos CSS ya preparados) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  
  <!-- Librer√≠a Font Awesome (para usar √≠conos) -->
  <script src="https://kit.fontawesome.com/a2d9d5b9d4.js" crossorigin="anonymous"></script>

  <style>
    /* === ESTILOS PERSONALIZADOS === */

    body {
      background-color: #d1fae5; /* Fondo verde muy claro */
    }

    /* Contenedor donde est√°n los tres botones (Presente, Tarde, Ausente) */
    .asistencia-buttons {
      display: flex; /* Los muestra en l√≠nea */
      justify-content: center; /* Centra horizontalmente */
      gap: 0.75rem; /* Espacio entre los botones */
    }

    /* Estilos base de los botones redondos */
    .asistencia-buttons button {
      border-radius: 50%;  /* Forma circular */
      width: 2.5rem;       /* Ancho fijo */
      height: 2.5rem;      /* Alto fijo */
      border: none;        /* Sin borde */
      cursor: pointer;     /* Cambia el cursor al pasar el mouse */
      transition: transform 0.15s ease, opacity 0.15s ease; /* Animaci√≥n suave */
    }

    /* Efecto al pasar el mouse sobre un bot√≥n */
    .asistencia-buttons button:hover {
      transform: scale(1.1); /* Aumenta ligeramente el tama√±o */
      opacity: 0.8;          /* Reduce un poco la opacidad */
    }

    /* Colores seg√∫n el tipo de asistencia */
    .presente { background-color: #199646; } /* Verde */
    .tarde { background-color: #facc15; }    /* Amarillo */
    .ausente { background-color: #ef4444; }  /* Rojo */

    /* Efecto visual para el bot√≥n seleccionado */
    .seleccionado {
      box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2); /* Borde difuminado alrededor */
      transform: scale(1.1); /* Un poco m√°s grande */
    }

    /* Fondo verde suave de las filas de la tabla */
    tbody {
      background-color: #f0fdf4;
    }
  </style>
</head>

<body>
  <!-- ======= BARRA SUPERIOR (NAVBAR) ======= -->
  <nav class="navbar is-success"> <!-- "is-success" aplica color verde oscuro -->
    <div class="navbar-brand">
      <a class="navbar-item has-text-weight-semibold" href="#">
        <span class="icon"><i class="fas fa-user-check"></i></span> <!-- √çcono del usuario -->
        <span>Panel del Preceptor</span> <!-- Texto del encabezado -->
      </a>
    </div>

    <div class="navbar-end">
      <div class="navbar-item">
        <!-- Bot√≥n para cerrar sesi√≥n -->
        <button class="button is-light" onclick="window.location.href='index.html'">
          <span class="icon"><i class="fas fa-sign-out-alt"></i></span> <!-- √çcono de salida -->
          <span>Cerrar sesi√≥n</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- ======= ENCABEZADO (HERO) ======= -->
  <section class="hero is-success is-small"> <!-- Hero de color verde y tama√±o peque√±o -->
    <div class="hero-body has-text-centered">
      <p class="title is-3">üìÖ Registro de Asistencias</p> <!-- T√≠tulo principal -->
      <p class="subtitle is-5">Marca la asistencia de cada alumno</p> <!-- Subt√≠tulo -->
    </div>
  </section>

  <!-- ======= CONTENIDO PRINCIPAL ======= -->
  <section class="section">
    <div class="container">
      <div class="columns is-centered"> <!-- Centra el contenido horizontalmente -->
        <div class="column is-10"> <!-- Columna que ocupa el 80% del ancho -->
          
          <div class="card"> <!-- Tarjeta principal -->
            <!-- Encabezado de la tarjeta -->
            <header class="card-header has-background-success">
              <p class="card-header-title has-text-white">
                <span class="icon mr-2"><i class="fas fa-clipboard-check"></i></span>
                Asistencia diaria
              </p>
            </header>

            <!-- Contenido dentro de la tarjeta -->
            <div class="card-content">
              <div class="field is-grouped is-justify-content-center mb-4">
                <!-- Selector de fecha -->
                <div class="control">
                  <input id="fechaAsistencia" class="input is-rounded is-success" type="date">
                </div>

                <!-- Bot√≥n para guardar -->
                <div class="control">
                  <button id="btnGuardar" class="button is-success is-rounded">
                    <span class="icon"><i class="fas fa-save"></i></span> <!-- √çcono de guardar -->
                    <span>Guardar Asistencia</span>
                  </button>
                </div>
              </div>

              <!-- Tabla de alumnos -->
              <div class="table-container">
                <table class="table is-striped is-hoverable is-fullwidth">
                  <thead>
                    <tr class="has-background-success has-text-white">
                      <th>Alumno</th> <!-- Columna con el nombre -->
                      <th class="has-text-centered">Marcar Asistencia</th> <!-- Columna de botones -->
                    </tr>
                  </thead>
                  <tbody id="tablaAlumnos" class="has-text-centered"></tbody> <!-- Aqu√≠ se insertan las filas din√°micamente -->
                </table>
              </div>
            </div>
          </div>

          <!-- Pie de p√°gina -->
          <div class="has-text-centered mt-5">
            <p class="is-size-7 has-text-grey">Sistema de Asistencias - Colegio Santa Mar√≠a ¬© 2025</p>
          </div>

        </div>
      </div>
    </div>
  </section>

  <!-- ======= SCRIPT PRINCIPAL ======= -->
  <script>
    // --- Lista de alumnos que se mostrar√°n en la tabla ---
    const alumnos = [
      "Ortiz Bautista","Romero Mia","Fernandez Lucia","Rodriguez Abril","Bedoya Agustina",
      "Rodriguez Ariana","Cortez Bruno","Omi√±uka Bruno","Portillo Catalina","Comparin Sofia",
      "Godoy Daniela","Britez Dinara","Cribb Elias","Rios Enzo","Pereira Franco","Rodiguez Joaquin",
      "Barzala Israel","Tschopp Juan","Damus Juan Lukas","Botello Matias","Figueredo Francisco",
      "Retamozo Nicolas","Oriana Sosa Batista","Alegre Siomara","Ruiz Diaz Sofia","Gimenez Tanya",
      "Bautista Victoria","Alonso Maira","Abimaela ","Josefina","Galarza Lautaro","Paiz Martina"
    ];

    // Referencias a elementos del HTML
    const tabla = document.getElementById("tablaAlumnos"); // Cuerpo de la tabla
    const btnGuardar = document.getElementById("btnGuardar"); // Bot√≥n de guardar

    // --- Crear din√°micamente las filas de la tabla ---
    alumnos.forEach(nombre => {
      const fila = document.createElement("tr"); // Crea una nueva fila <tr>
      fila.innerHTML = `
        <td>${nombre}</td> <!-- Muestra el nombre del alumno -->
        <td>
          <div class="asistencia-buttons">
            <!-- Tres botones: presente, tarde, ausente -->
            <button class="presente" data-estado="Presente" title="Presente"></button>
            <button class="tarde" data-estado="Tarde" title="Tarde"></button>
            <button class="ausente" data-estado="Ausente" title="Ausente"></button>
          </div>
        </td>
      `;
      tabla.appendChild(fila); // Agrega la fila al cuerpo de la tabla
    });

    // --- Detectar clics sobre los botones de asistencia ---
    tabla.addEventListener("click", e => {
      if (e.target.tagName === "BUTTON") { // Solo si se hace clic en un bot√≥n
        const grupo = e.target.parentElement.querySelectorAll("button"); // Obtiene los 3 botones del mismo alumno
        grupo.forEach(btn => btn.classList.remove("seleccionado")); // Quita la selecci√≥n previa
        e.target.classList.add("seleccionado"); // Marca el bot√≥n clickeado
      }
    });

    // --- Guardar la asistencia en el almacenamiento local del navegador ---
    btnGuardar.addEventListener("click", () => {
      const fecha = document.getElementById("fechaAsistencia").value; // Toma la fecha elegida
      if (!fecha) { // Si no hay fecha
        alert("‚ö†Ô∏è Debe seleccionar una fecha."); // Muestra advertencia
        return; // Sale sin guardar
      }

      const registros = []; // Arreglo donde se guardar√°n los resultados

      // Recorre cada fila de la tabla
      document.querySelectorAll("#tablaAlumnos tr").forEach(fila => {
        const nombre = fila.querySelector("td:first-child").textContent; // Obtiene el nombre del alumno
        const seleccionado = fila.querySelector(".seleccionado"); // Verifica si hay un bot√≥n seleccionado
        const estado = seleccionado ? seleccionado.dataset.estado : "Sin marcar"; // Guarda el estado o ‚ÄúSin marcar‚Äù
        registros.push({ nombre, estado }); // A√±ade el registro al arreglo
      });

      // Obtiene asistencias previas o crea un objeto vac√≠o
      const asistencias = JSON.parse(localStorage.getItem("asistencias")) || {};
      
      // Guarda la asistencia actual bajo la fecha seleccionada
      asistencias[fecha] = registros;

      // Guarda todo en localStorage convertido a texto
      localStorage.setItem("asistencias", JSON.stringify(asistencias));

      alert("‚úÖ Asistencia guardada correctamente."); // Mensaje de √©xito
    });
  </script>
</body>
</html>
